<div
	class="dropzone"
	dropZone
	(hovered)="toggleHover($event)"
	(dropped)="startUpload($event)"
	[class.hovering]="isHovering"
>
	<h3>Upload a video</h3>
	<div>
		<label>
			<input type="file" (change)="startUpload($event.target.files)" />
		</label>
	</div>
</div>

<div *ngIf="percentage | async as pct">
	<progress class="progress is-info" [value]="pct" max="100"> </progress
	>{{ pct | number }}%
</div>

<div *ngIf="snapshot | async as snap">
	{{ snap.bytesTransferred }} of {{ snap.totalBytes }}
	<button
		(click)="task.pause()"
		class="btn btn-danger"
		[disabled]="!isActive(snap)"
	>
		Pause
	</button>
	<button
		(click)="task.cancel()"
		class="btn btn-secondary"
		[disabled]="!isActive(snap)"
	>
		Cancel
	</button>
	<button
		(click)="task.resume()"
		class="btn btn-primary"
		[disabled]="!(snap?.state === 'paused')"
	>
		Resume
	</button>
</div>

<div *ngIf="videoUploaded">
	<div *ngIf="!titleSet; else titleSetTrue">
		<form [formGroup]="videoTitle" (ngSubmit)="setTitle()">
			<p>Set video title</p>
			<div class="form-group">
				<input
					type="text"
					class="form-control"
					placeholder="Title"
					required="required"
					formControlName="title"
				/>
			</div>
			<div class="form-group">
				<button type="submit" class="btn btn-primary">
					Set Title
				</button>
			</div>
		</form>
		Video Uploaded Successfully
	</div>
</div>

<ng-template #titleSetTrue>
	<p>
		Go to video -
		<a routerLink="/vid/{{ videoId }}">{{ videoTitle.value.title }}</a>
	</p>
</ng-template>
